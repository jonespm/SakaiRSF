<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" 
  "http://www.springframework.org/dtd/spring-beans.dtd">
<!-- Contains bean overrides and new definitions for application-scope beans
  required for integration of RSF apps into Sakai -->
<beans>

  <bean id="flowTokenStateHolder"
    class="uk.ac.cam.caret.sakai.rsf.state.InSakaiSessionTSH">
    <property name="sessionManager"
      ref="org.sakaiproject.tool.api.SessionManager" />
    <property name="expirySeconds">
      <!-- deliberately short time for testing - all flows will expire after 
        30 seconds of disuse -->
      <value>30</value>
    </property>
  </bean>

  <bean id="bandgapStateHolder"
    class="uk.ac.cam.caret.sakai.rsf.state.InSakaiSessionTSH">
    <property name="sessionManager"
      ref="org.sakaiproject.tool.api.SessionManager" />
    <property name="expirySeconds">
      <!-- deliberately short time for testing - all errors will expire after 
        10 seconds of disuse -->
      <value>10</value>
    </property>
  </bean>
  <!--  no problem declaring this here since Sakai already has commons-upload 
    in shared. -->
  <bean id="multipartResolver"
    class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
  </bean>

  <bean id="sakai-ContextProxy" parent="RSACStringBridge">
    <property name="targetBeanName" value="sakai-Context" />
  </bean>

  <bean id="messageLocator"
    class="uk.org.ponder.springutil.SpringMessageLocator">
    <property name="messageSource" ref="messageSource" />
    <property name="localeGetter" ref="requestLocaleProxy" />
  </bean>

  <bean parent="templateParseInterceptorParent">
    <property name="value">
      <bean class="uk.ac.cam.caret.sakai.rsf.template.SakaiBodyTPI" />
    </property>
  </bean>

  <bean id="sakai-PermissionChecker"
    class="uk.ac.cam.caret.sakai.rsf.util.PermissionChecker">
    <property name="securityService"
      ref="org.sakaiproject.authz.api.SecurityService" />
    <property name="toolManager" ref="org.sakaiproject.tool.api.ToolManager" />
  </bean>

  <bean id="rsf-dummy-SakaiResourceLoader"
    class="org.sakaiproject.util.ResourceLoader" />

  <bean id="sakai-LocaleSetter"
    class="uk.ac.cam.caret.sakai.rsf.locale.SakaiLocaleSetter">
    <property name="sessionManager"
      ref="org.sakaiproject.tool.api.SessionManager" />
  </bean>

  <bean id="frameAdjustingProducer"
    class="uk.ac.cam.caret.sakai.rsf.producers.FrameAdjustingProducer">
    <property name="toolManager" ref="org.sakaiproject.tool.api.ToolManager" />
  </bean>
  
  <bean id="helperHandlerHook" parent="handlerHookParent" 
      class="uk.ac.cam.caret.sakai.rsf.helper.HelperHandlerHook">
    <property name="viewParametersProxy" ref="viewParametersProxy" />
    <property name="helperHandlerHookBean"
      ref="helperHandlerHookBeanProxy" />
  </bean>
  
  <bean id="helperHandlerHookBeanProxy" parent="RSACBridgeProxy">
    <property name="targetBeanName" value="helperHandlerHookBean"/>
  </bean>
  
</beans>